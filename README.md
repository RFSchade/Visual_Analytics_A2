# Visual Analytics Assignment 2
## Assignment description
This repository contains my solutions to assignment 2 for the Visual Analytics course at Aarhus university. The goal of this assignment is to classify pre-annotated image data using machine learning in two ways: Using a simple logistic regression, and using a fully connected, feed-forward neural network.     
The program should also output a classification report.    
The pre-annotated image data was sourced from the [cifar10 tensorflow dataset](https://www.tensorflow.org/datasets/catalog/cifar10) and [mnist_784 OpenML dataset](https://www.openml.org/search?type=data&sort=runs&id=554&status=active)

## Methods 
Classification was done using a logistic regression, a simple neural network written in numpy by and an additional, fully connected neural network created using the tensorflow module.    
To serve as input for all three models, the cifar10 data had to be converted to grey-scale and flattened.      

## Repository structure
in: Folder for input data (mnist_784 and cifar10 data is loaded using scikit-learn and tensorflow functions respectively, and as such the script cannot load data from this folder)     
output: Folder for the output generated by the scrips – at present it contains 8 files:     
-	history_img_cifar.png: 
    -	Generated by running the tensorflow_nn.py script with the cifar_10 data – an image containing two graphs – one that tracks the training and validation loss across epochs, and one that does the same for the training and validation accuracy 
-	history_img_mnist.png: 
    -	Generated by running the tensorflow_nn.py script with the mnist_784 data – an image containing two graphs – one that tracks the training and validation loss across epochs, and one that does the same for the training and validation accuracy
-	lr_report_cifar.txt: 
    -	Generated by running the logistic_regression.py script with the cifar_10 data – a .txt file containing the classification report of the model
-	lr_report_mnist.txt: 
    -	Generated by running the logistic_regression.py script with the mnist_784 data – a .txt file containing the classification report of the model
-	nn_report_cifar.txt: 
    -	Generated by running the nn_classifier.py script with the cifar_10 data – a .txt file containing the classification report of the model
-	nn_report_mnist.txt: 
    -	Generated by running the nn_classifier.py script with the mnist_784 data – a .txt file containing the classification report of the model
-	tensorflow_report_cifar.txt: 
    -	Generated by running the tensorflow_nn.py script with the cifar_10 data – a .txt file containing the classification report of the model
-	tensorflow_report_mnist.txt: 
    -	Generated by running the tensorflow_nn.py script with the mnist_784 data – a .txt file containing the classification report of the model    

src: Folder for python scripts – contains three scripts: (in addition to init)
- \_\_init__.py
-	logistic_regression.py 
-	nn_classifier.py
-	tensorflow_nn.py

utils: Contains utility functions written by course instructor [Ross Deans Kristensen-McLachlan](https://github.com/rdkm89)    
github_link.txt: link to github repository    
requirements.txt: txt file containing the modules required to run the code    

## Usage 
Modules listed in requirements.txt should be installed before scripts are run.    
__Logistic_regression.py__    
To train and evaluate a logistic regression model, run logistic_regression.py from the Visual_analytics_A2 repository folder. The script has one argument:    
- _-d or -data: the data to fit the model to - either 'cifar' or 'mnist'. This argument is required._

Example of code running the script from the terminal:    
```
python src/logistic_regression.py -d mnist
```
__nn_classifier.py__    
To train and evaluate a fully connected, feed-forward neural network written in using the numpy module, run nn_classifer.py from the Visual_analytics_A2 repository folder. The script has one argument:    
- _-d or -data: the data to fit the model to - either 'cifar' or 'mnist'. This argument is required._

Example of code running the script from the terminal:
```
python src/nn_classifer.py -d mnist
```
__tensorflow_nn.py__
To train and evaluate a fully connected, feed-forward neural network created using the tensorflow module, run tensorflow_nn.py from the Visual_analytics_A2 repository folder. The script has one argument:    
- _-d or -data: the data to fit the model to - either 'cifar' or 'mnist'. This argument is required._

Example of code running the script from the terminal:    
```
python src/tensorflow_nn.py -d mnist
```

## Discussion of results
Overall, the three models seem to fare better on the mnist_784 data – this is unsurprising, considering that the handwritten numbers of this database are simple, and translate easily without losing too much information to a greyscale image. In contrast, the cifar10 dataset is much more complex.    
The tenserflow_nn.py script does perform slightly better on the cifar10 data in terms of classification than the others, but even then you can see on the history_img_cifar.png image that the loss and accuracy of the test and validation data diverge significantly for each other, which may be a sign of overfitting.     
